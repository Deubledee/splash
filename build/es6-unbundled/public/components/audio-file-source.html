<html><head><link rel="import" href="../bower_components/polymer/polymer-element.html"></head><body><dom-module id="audio-file-source"><template><style include="shared-styles-typeG">:host{width:100%;margin-right:var(--app-standart-border-radius);}article{box-shadow:var( --app-type-gain-box-shadow);border-radius:var(--app-standart-border-radius);margin-top:6px;width:164px;background-color:var(--app-primary-background-color);padding-left:9px;display:flex;flex-flow:column;min-height:107px;}audio{width:128px;}paper-icon-button{color:var(--app-color);}aside[apllyWith]{border-top:0.4px solid #b6b6b6b3;}section[list-box-hiden]{display:none;}section[list-box-hiden][boxShow]{display:block;}audio{width:165px;}#apllyNow{display:none;}input{display:none;}label{color:var(--app-color);cursor:pointer;}paper-button.diferent{box-shadow:var(--app-toolbar-box-shadow);}label[for="range"]{width:90px;margin-top:7px;}div[inline]{display:flex;flex-flow:row;box-sizing:border-box;padding:2px;}section[boxShow]{display:none;}button{height:24px;margin-top:6px;}</style><article><div inline=""><label for="range" title="[[elemTitle]]">[[elemTitle]] [[loading]]</label><paper-icon-button icon="input" title="[[type]]"></paper-icon-button><button on-click="removeCall">x</button></div><section id="title" boxshow$="[[boxShow]]"><paper-button id="art" class="diferent"><label id="label" for="input">Insert File</label></paper-button><input id="input" aria-labelledby="" type="file" on-change="submit" class="diferent"></section><section id="title" boxshow$="[[!boxShow]]"><audio-player slot="applyButton" id="player" active="[[apllyWith]]" audio="{{source}}" elemtitle="[[elemTitle]]"></audio-player><audio-aplly-with id="aplyWith" agent-class="[[agentClass]]" title-funcion="[[titleFuncion]]" elem-title="[[elemTitle]]"><paper-button slot="applyButton" id="apllyNow" on-click="apllyNow"></paper-button></audio-aplly-with></section></article></template><script>class audioFileSource extends Polymer.Element{static get is(){return"audio-file-source"}constructor(){super()}ready(){super.ready();window.addEventListener("connected",event=>{if(this.elemTitle===event.detail.connected){this.connected=event.detail.state;console.log(this.connected);if(!0===this.record&&!1===this.connected){this.cancelRecording()}}},!1)}static get properties(){return{agentClass:{type:Object},emTitle:{type:String},titleFuncion:{type:String,notify:!0,value:"Source"},file:{type:Object},timeView:{type:Boolean,value:!0},loading:{type:String},Elapsed:{type:String,value:"00:00"},state:{type:String,value:"inactive..."},start:{type:Object,observer:"submit"},disable:{type:Boolean,value:!0,notify:!0,reflectToAttribute:!0},boxShow:{type:Boolean,value:!1,notify:!0,reflectToAttribute:!0},source:{type:Object,observer:"setSource"},type:{type:String,value:"source"},open:{type:Boolean,value:!0,notify:!0,reflectToAttribute:!0},count:{type:Number,value:0}}}apllyNow(){this.$.player.click();let that=this.agentClass;if(that.appliesWith[this.$.player.name]){for(let i=0;i<that.appliesWith[this.$.player.name].length;i++){that.appliesWith[this.$.player.name][i].elem.click()}}}timeupdate(event){let timeupdate=!0===this.timeView?(""+event.timeStamp).split(".")[0]:event.path[0].currentTime;this.$.audio.controls=!1;this.Elapsed=timeupdate.toString()}toggleTimeView(){this.timeView=!this.timeView}submit(event){var fileName=event.target.value.split("\\").pop();let input=event.target,reader=new FileReader;reader.onprogress=()=>{this.loading="loading..."};reader.onload=()=>{var dataURL=reader.result;this.$.player.url=dataURL;setTimeout(()=>{this.loading="loaded...";setTimeout(()=>{this.loading="";this.elemTitle=fileName},500)},1e3)};reader.readAsDataURL(input.files[0])}setSource(src){setTimeout(()=>{this.agentClass.setElementSource(err=>{if("object"===typeof err){throw this.error("input ",err)}else if("string"===typeof err){this.elemTitle="already exists";setTimeout(()=>{this.elemTitle=""},1e3)}if(!1===err){var that=this;window.dispatchEvent(new CustomEvent("connect",{detail:{element:that}}));window.dispatchEvent(new CustomEvent("elemem-title",{detail:{title:this.elemTitle}}));window.dispatchEvent(new CustomEvent("source",{detail:{name:this.elemTitle,type:this.type}}));this.boxShow=!0}},this.elemTitle,src)},2e3)}error(msg,err){console.error(msg,err)}removeCall(){if(this.agentClass.sourceNode[this.elemTitle]){window.dispatchEvent(new CustomEvent("remove-source",{detail:{name:this.elemTitle,type:this.type}}));setTimeout(()=>{this.agentClass.removeAgents(()=>{this.agentClass.revoveElemTitle(()=>{window.dispatchEvent(new CustomEvent("apllywith",{detail:{title:this.elemTitle}}));window.dispatchEvent(new CustomEvent("remove-elem",{detail:{title:this.elemTitle}}));this.$.player.stopSong();this.parentElement.removeChild(this)},this.elemTitle)},"sourceNode",this.elemTitle)},100)}else{this.parentElement.removeChild(this);window.dispatchEvent(new CustomEvent("remove-elem",{detail:{title:this.elemTitle}}))}}}window.customElements.define(audioFileSource.is,audioFileSource);</script></dom-module></body></html>